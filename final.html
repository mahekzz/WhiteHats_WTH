<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SleepyJuan Control</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8f0ff 0%, #e8f4fd 100%);
            color: #333333;
            overflow-x: hidden;
            user-select: none;
            touch-action: manipulation;
        }

        .phone-container {
            width: 375px;
            height: 812px;
            margin: 20px auto;
            background: #000000;
            border-radius: 40px;
            padding: 8px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .screen {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #faf7ff 0%, #f0f9ff 100%);
            border-radius: 30px;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .status-bar {
            height: 44px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .time { 
            color: #4a5568; 
        }
        
        .battery { 
            display: flex; 
            align-items: center; 
            gap: 5px;
            color: #4a5568;
        }

        .battery-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #48bb78;
        }

        #homeScreen {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .welcome-header {
            background: linear-gradient(135deg, #e879f9 0%, #c084fc 100%);
            padding: 30px 20px 40px;
            position: relative;
            overflow: hidden;
        }

        .welcome-header::before {
            content: '';
            position: absolute;
            top: -40%;
            right: -20%;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            z-index: 1;
        }

        .welcome-header::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -10%;
            width: 150px;
            height: 150px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            z-index: 1;
        }

        .welcome-content {
            position: relative;
            z-index: 2;
        }

        .greeting-text {
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .user-name {
            color: #ffffff;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .welcome-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 400;
            margin-bottom: 20px;
        }

        .profile-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .profile-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .profile-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .profile-details h3 {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .profile-details p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            font-weight: 400;
        }

        .notification-badge {
            background: #f87171;
            color: #ffffff;
            font-size: 10px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
            min-width: 20px;
            text-align: center;
        }

        .content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            background: #ffffff;
            border-radius: 25px 25px 0 0;
            margin-top: -25px;
            position: relative;
            z-index: 3;
            max-height: calc(100vh - 250px);
            padding-bottom: 100px;
        }

        .content-header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 15px;
        }

        .content-title {
            color: #c084fc;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .content-subtitle {
            color: #64748b;
            font-size: 14px;
            font-weight: 500;
        }

        .main-led {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.5s ease;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
        }

        .main-led.pulsing {
            animation: pulse 2s infinite !important;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1); 
                opacity: 0.8; 
            }
            50% { 
                transform: scale(1.05); 
                opacity: 1; 
            }
        }

        .led-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgb(255, 71, 87);
            border-radius: 50%;
            opacity: 0.3;
            filter: blur(20px);
        }

        .led-core {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgb(255, 71, 87);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .action-btn {
            height: 60px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .action-btn:nth-child(1) {
            background: linear-gradient(135deg, #fde047 0%, #facc15 100%);
            color: #374151;
        }

        .action-btn:nth-child(2) {
            background: linear-gradient(135deg, #a7f3d0 0%, #6ee7b7 100%);
            color: #374151;
        }

        .action-btn:nth-child(3) {
            background: linear-gradient(135deg, #93c5fd 0%, #60a5fa 100%);
        }

        .action-btn:nth-child(4) {
            background: linear-gradient(135deg, #f9a8d4 0%, #f472b6 100%);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .action-btn.active {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .mood-section {
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 2px solid #fce7f3;
            color: #c084fc;
            font-size: 24px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .mood-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .mood-btn {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: 14px;
            font-weight: 500;
            padding: 12px 16px;
            border: none;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.2px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08);
        }

        .mood-btn[data-mood="happy"] {
            background-color: #fef08a;
            color: #a16207;
        }

        .mood-btn[data-mood="calm"] {
            background-color: #bfdbfe;
            color: #1e40af;
        }

        .mood-btn[data-mood="energetic"] {
            background-color: #fca5a5;
            color: #b91c1c;
        }

        .mood-btn[data-mood="romantic"] {
            background-color: #f9a8d4;
            color: #be185d;
        }

        .mood-btn[data-mood="focus"] {
            background-color: #d8b4fe;
            color: #7c3aed;
        }

        .mood-btn[data-mood="party"] {
            background-color: #86efac;
            color: #15803d;
        }

        .mood-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 18px rgba(0, 0, 0, 0.15);
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        button {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: 16px;
            font-weight: 500;
            padding: 15px 25px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.3px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .wellness-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 1px solid #e2e8f0;
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #c084fc;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: #64748b;
            font-weight: 500;
        }

        .card {
            background: linear-gradient(135deg, #fef7ff 0%, #faf5ff 100%);
            border: 1px solid #e9d5ff;
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(196, 132, 252, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(196, 132, 252, 0.15);
        }

        .wellness-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .wellness-card-header .emoji {
            font-size: 24px;
        }

        .wellness-card-title {
            color: #7c3aed;
            font-weight: 600;
            font-size: 16px;
        }

        .wellness-card-subtitle {
            color: #8b5cf6;
            font-size: 12px;
            margin-top: 4px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(196, 132, 252, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(196, 132, 252, 0.4);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #f8f0ff 0%, #e8f4fd 100%);
            height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 500;
            border-top: 1px solid rgba(196, 132, 252, 0.1);
        }

        .nav-container {
            background: rgba(139, 92, 246, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 8px 15px;
            display: flex;
            gap: 15px;
            border: 1px solid rgba(196, 132, 252, 0.2);
        }

        .nav-item {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.3);
        }

        .nav-item:hover {
            transform: translateY(-2px);
            background: rgba(255,255,255,0.5);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            box-shadow: 0 4px 15px rgba(196, 132, 252, 0.4);
        }

        .nav-icon {
            font-size: 18px;
            filter: brightness(1.1);
        }

        .screen-hidden {
            display: none;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(139, 92, 246, 0.1);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .popup-content {
            background: #ffffff;
            width: 90%;
            max-width: 350px;
            max-height: 70vh;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(139, 92, 246, 0.15);
            transform: translateY(30px) scale(0.9);
            transition: all 0.3s ease;
            border: 1px solid rgba(196, 132, 252, 0.1);
        }

        .popup-overlay.active .popup-content {
            transform: translateY(0) scale(1);
        }

        .popup-header {
            padding: 25px 25px 20px;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #fef7ff 0%, #faf5ff 100%);
        }

        .popup-header h3 {
            color: #7c3aed;
            font-size: 18px;
            font-weight: 700;
            margin: 0;
        }

        .popup-close {
            width: 80px;
            height: 35px;
            border-radius: 15px;
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            border: none;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(196, 132, 252, 0.3);
        }

        .popup-close:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(196, 132, 252, 0.4);
        }

        .popup-body {
            padding: 25px;
            max-height: 50vh;
            overflow-y: auto;
        }

        .effect-list {
            margin: 10px 0;
        }

        .effect-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: linear-gradient(135deg, #fef7ff 0%, #faf5ff 100%);
            border-radius: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #e9d5ff;
        }

        .effect-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(196, 132, 252, 0.1);
        }

        .effect-toggle {
            width: 50px;
            height: 28px;
            background: linear-gradient(135deg, #e9d5ff 0%, #ddd6fe 100%);
            border-radius: 14px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-thumb {
            width: 24px;
            height: 24px;
            background: #ffffff;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(196, 132, 252, 0.2);
        }

        .effect-toggle.active {
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
        }

        .effect-toggle.active .toggle-thumb {
            transform: translateX(22px);
        }

        .slider-container {
            margin: 25px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 14px;
            font-weight: 600;
            color: #7c3aed;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(135deg, #e9d5ff 0%, #ddd6fe 100%);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(196, 132, 252, 0.3);
        }

        .breathing-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
            transition: all 4s ease;
            background: linear-gradient(135deg, #c084fc 0%, #a855f7 100%);
            color: white;
            opacity: 0.7;
            box-shadow: 0 8px 25px rgba(196, 132, 252, 0.3);
        }

        .breathing-circle.inhale {
            transform: scale(1.3);
            opacity: 1;
        }

        .breathing-circle.exhale {
            transform: scale(0.8);
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="phone-container">
        <div class="screen">
            <!-- Status Bar -->
            <div class="status-bar">
                <div class="time" id="currentTime">9:41 PM</div>
                <div class="battery">
                    <div class="battery-dot" id="batteryDot"></div>
                    <span id="batteryLevel">85%</span>
                </div>
            </div>

            <!-- Home Screen -->
            <div id="homeScreen">
                <div class="welcome-header">
                    <div class="welcome-content">
                        <div class="greeting-text">Good Evening</div>
                        <div class="user-name">Welcome back, Alex!</div>
                        <div class="welcome-subtitle">Ready to wind down for the night?</div>
                        
                        <div class="profile-section">
                            <div class="profile-info">
                                <div class="profile-avatar">🌙</div>
                                <div class="profile-details">
                                    <h3>Juan's here to help</h3>
                                    <p>Your wellness companion</p>
                                </div>
                            </div>
                            <div class="notification-badge">3</div>
                        </div>
                    </div>
                </div>

                <div class="content">
                    <div class="content-header">
                        <div class="content-title">SleepyJuan Control</div>
                        <div class="content-subtitle">Your Digital Sleep Buddy</div>
                    </div>

                    <div class="main-led" id="mainLED">
                        <div class="led-glow" id="ledGlow"></div>
                        <div class="led-core" id="ledCore">LED</div>
                    </div>

                    <div style="text-align: center; margin-bottom: 25px;">
                        <div id="colorStatus" style="color: #64748b; font-size: 14px; font-weight: 500;">Current: Red #FF4757</div>
                    </div>

                    <div class="quick-actions">
                        <button class="action-btn" id="pulseBtn">Pulse</button>
                        <button class="action-btn" id="randomBtn">Random</button>
                        <button class="action-btn" id="effectsBtn">Effects</button>
                        <button class="action-btn" id="buzzerBtn">Buzz</button>
                    </div>

                    <div class="mood-section">
                        <div>Choose Your Mood</div>
                        <div class="mood-buttons">
                            <button class="mood-btn" data-mood="happy" id="Happy">Happy</button>
                            <button class="mood-btn" data-mood="calm" id="Calm">Calm</button>
                            <button class="mood-btn" data-mood="energetic" id="Energetic">Energetic</button>
                            <button class="mood-btn" data-mood="romantic" id="Romantic">Romantic</button>
                            <button class="mood-btn" data-mood="focus" id="Focus">Focus</button>
                            <button class="mood-btn" data-mood="party" id="Party">Party</button>
                        </div>
                    </div>

                    <div class="wellness-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="screenTime">4h 32m</div>
                            <div class="stat-label">Screen Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="sleepScore">78%</div>
                            <div class="stat-label">Sleep Quality</div>
                        </div>
                    </div>

                    <div class="card" id="wellnessCard">
                        <div class="wellness-card-header">
                            <div class="emoji">🌙</div>
                            <div>
                                <div class="wellness-card-title">Ready for Sleep Mode?</div>
                                <div class="wellness-card-subtitle">Jon suggests starting your wind-down routine</div>
                            </div>
                        </div>
                        <button class="btn-primary" id="sleepModeBtn">START SLEEP ROUTINE</button>
                    </div>
                </div>
            </div>

            <!-- Effects Popup -->
            <div id="effectsPopup" class="popup-overlay">
                <div class="popup-content">
                    <div class="popup-header">
                        <h3>Light Effects</h3>
                        <button class="popup-close" onclick="closeEffectsPopup()">Save</button>
                    </div>
                    <div class="popup-body">
                        <div class="effect-list">
                            <div class="effect-item" onclick="toggleEffect('rainbow')">
                                <div>
                                    <div style="font-weight: 600; color: #7c3aed;">Rainbow Cycle</div>
                                    <div style="font-size: 12px; color: #8b5cf6;">Smooth color transitions</div>
                                </div>
                                <div class="effect-toggle" id="rainbowToggle">
                                    <div class="toggle-thumb"></div>
                                </div>
                            </div>

                            <div class="effect-item" onclick="toggleEffect('breathing')">
                                <div>
                                    <div style="font-weight: 600; color: #7c3aed;">Breathing</div>
                                    <div style="font-size: 12px; color: #8b5cf6;">Gentle pulsing light</div>
                                </div>
                                <div class="effect-toggle" id="breathingToggle">
                                    <div class="toggle-thumb"></div>
                                </div>
                            </div>

                            <div class="effect-item" onclick="toggleEffect('strobe')">
                                <div>
                                    <div style="font-weight: 600; color: #7c3aed;">Strobe</div>
                                    <div style="font-size: 12px; color: #8b5cf6;">Fast flashing</div>
                                </div>
                                <div class="effect-toggle" id="strobeToggle">
                                    <div class="toggle-thumb"></div>
                                </div>
                            </div>

                            <div class="effect-item" onclick="toggleEffect('redTherapy')">
                                <div>
                                    <div style="font-weight: 600; color: #7c3aed;">Red Light Therapy</div>
                                    <div style="font-size: 12px; color: #8b5cf6;">Sleep preparation mode</div>
                                </div>
                                <div class="effect-toggle" id="redTherapyToggle">
                                    <div class="toggle-thumb"></div>
                                </div>
                            </div>
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Effect Speed</span>
                                <span id="speedValue">50%</span>
                            </div>
                            <input type="range" class="slider" id="speedSlider" min="10" max="100" value="50">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Breathing Exercise Popup -->
            <div id="breathingOverlay" class="popup-overlay">
                <div class="popup-content">
                    <div class="popup-header">
                        <h3>Breathe with Juan</h3>
                        <button class="popup-close" onclick="stopBreathing()">Stop</button>
                    </div>
                    <div class="popup-body" style="text-align: center;">
                        <div class="breathing-circle" id="breathingCircle">INHALE</div>
                        <div id="breathingInstructions" style="margin: 15px 0; color: #8b5cf6;">Follow the circle. Inhale for 4, hold for 7, exhale for 8</div>
                        <div style="margin: 10px 0;">
                            <span style="color: #c084fc;">Cycle </span>
                            <span id="breathingCycle">1</span>
                            <span style="color: #8b5cf6;"> of 5</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Navigation -->
            <div class="bottom-nav">
                <div class="nav-container">
                    <div class="nav-item active" data-page="home">
                        <div class="nav-icon">🏠</div>
                    </div>
                    <div class="nav-item" data-page="palette">
                        <div class="nav-icon">🎨</div>
                    </div>
                    <div class="nav-item" data-page="effects">
                        <div class="nav-icon">✨</div>
                    </div>
                    <div class="nav-item" data-page="sleep">
                        <div class="nav-icon">🌙</div>
                    </div>
                    <div class="nav-item" data-page="settings">
                        <div class="nav-icon">⚙️</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let currentScreen = 'home';
        let currentColor = { r: 255, g: 71, b: 87 };
        let activeEffects = {
            rainbow: false,
            breathing: false,
            strobe: false,
            redTherapy: false
        };
        let effectIntervals = {};
        let screenTimeMinutes = 272;
        let batteryLevel = 85;
        let lastTouchEnd = 0;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            updateTime();
            setInterval(updateTime, 1000);
            setInterval(updateBattery, 30000);
            setInterval(updateScreenTime, 60000);
            
            setupEventListeners();
            updateLEDDisplay();
            updateStats();
            updateGreeting();
            setupBottomNavigation();
        });

        // Setup event listeners
        function setupEventListeners() {
            const pulseBtn = document.getElementById('pulseBtn');
            if (pulseBtn) {
                pulseBtn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const led = document.getElementById('mainLED');
                    if (led) led.classList.toggle('pulsing');
                });
            }

            const randomBtn = document.getElementById('randomBtn');
            if (randomBtn) {
                randomBtn.addEventListener('click', function() {
                    const r = Math.floor(Math.random() * 256);
                    const g = Math.floor(Math.random() * 256);
                    const b = Math.floor(Math.random() * 256);
                    setPresetColor(r, g, b);
                });
            }

            const effectsBtn = document.getElementById('effectsBtn');
            if (effectsBtn) {
                effectsBtn.addEventListener('click', openEffectsPopup);
            }

            const buzzerBtn = document.getElementById('buzzerBtn');
            if (buzzerBtn) {
                buzzerBtn.addEventListener('click', function() {
                    if ('vibrate' in navigator) {
                        navigator.vibrate([50, 30, 50]);
                    }
                });
            }

            const sleepModeBtn = document.getElementById('sleepModeBtn');
            if (sleepModeBtn) {
                sleepModeBtn.addEventListener('click', startBreathingExercise);
            }

            const speedSlider = document.getElementById('speedSlider');
            const speedValue = document.getElementById('speedValue');
            
            if (speedSlider && speedValue) {
                speedSlider.addEventListener('input', function() {
                    speedValue.textContent = this.value + '%';
                    updateEffectSpeeds();
                });
            }

            // Close popup when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('popup-overlay')) {
                    closeEffectsPopup();
                }
            });
        }

        // Bottom navigation
        function setupBottomNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    const page = this.getAttribute('data-page');
                    handleNavigation(page);
                });
            });
        }

        function handleNavigation(page) {
            switch(page) {
                case 'home':
                    break;
                case 'palette':
                    break;
                case 'effects':
                    openEffectsPopup();
                    break;
                case 'sleep':
                    startSleepMode();
                    break;
                case 'settings':
                    break;
            }
        }

        // Update functions
        function updateGreeting() {
            const hour = new Date().getHours();
            let greeting = "Good Evening";
            let subtitle = "Ready to wind down for the night?";
            
            if (hour < 12) {
                greeting = "Good Morning";
                subtitle = "Start your day with great lighting!";
            } else if (hour < 17) {
                greeting = "Good Afternoon";
                subtitle = "How's your day going?";
            }
            
            const greetingEl = document.querySelector('.greeting-text');
            const subtitleEl = document.querySelector('.welcome-subtitle');
            if (greetingEl) greetingEl.textContent = greeting;
            if (subtitleEl) subtitleEl.textContent = subtitle;
        }

        function updateTime() {
            const now = new Date();
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12;
            
            const timeEl = document.getElementById('currentTime');
            if (timeEl) timeEl.textContent = `${hours}:${minutes} ${ampm}`;
        }

        function updateBattery() {
            batteryLevel = Math.max(20, batteryLevel - Math.floor(Math.random() * 3));
            const batteryEl = document.getElementById('batteryLevel');
            if (batteryEl) batteryEl.textContent = `${batteryLevel}%`;
            
            const dot = document.getElementById('batteryDot');
            if (dot) {
                if (batteryLevel < 30) {
                    dot.style.background = '#ef4444';
                } else if (batteryLevel < 60) {
                    dot.style.background = '#f59e0b';
                } else {
                    dot.style.background = '#10b981';
                }
            }
        }

        function updateScreenTime() {
            screenTimeMinutes += Math.floor(Math.random() * 2);
            const hours = Math.floor(screenTimeMinutes / 60);
            const mins = screenTimeMinutes % 60;
            const screenTimeEl = document.getElementById('screenTime');
            if (screenTimeEl) screenTimeEl.textContent = `${hours}h ${mins}m`;
        }

        // Effects popup functions
        function openEffectsPopup() {
            const popup = document.getElementById('effectsPopup');
            if (popup) {
                popup.classList.add('active');
            }
        }

        function closeEffectsPopup() {
            const popup = document.getElementById('effectsPopup');
            if (popup) {
                popup.classList.remove('active');
            }
        }

        function toggleEffect(effectId) {
            const toggle = document.getElementById(effectId + 'Toggle');
            if (toggle) {
                const isActive = toggle.classList.contains('active');
                
                if (isActive) {
                    toggle.classList.remove('active');
                    activeEffects[effectId] = false;
                    stopEffect(effectId);
                } else {
                    toggle.classList.add('active');
                    activeEffects[effectId] = true;
                    startEffect(effectId);
                }
            }
        }

        // Color management
        function updateLEDDisplay() {
            const { r, g, b } = currentColor;
            const colorString = `rgb(${r}, ${g}, ${b})`;
            const hexColor = `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`.toUpperCase();
            
            const leds = ['mainLED'];
            leds.forEach(ledId => {
                const led = document.getElementById(ledId);
                if (led) {
                    const core = led.querySelector('[id$="Core"]');
                    const glow = led.querySelector('[id$="Glow"]');
                    
                    if (core) core.style.background = colorString;
                    if (glow) glow.style.background = colorString;
                }
            });
            
            const colorStatus = document.getElementById('colorStatus');
            if (colorStatus) {
                colorStatus.textContent = `Current: ${getColorName(r, g, b)} ${hexColor}`;
            }
        }

        function getColorName(r, g, b) {
            if (r > 200 && g < 100 && b < 100) return 'Red';
            if (r < 100 && g > 200 && b < 100) return 'Green';
            if (r < 100 && g < 100 && b > 200) return 'Blue';
            if (r > 200 && g > 200 && b < 100) return 'Yellow';
            if (r > 200 && g < 100 && b > 200) return 'Magenta';
            if (r < 100 && g > 200 && b > 200) return 'Cyan';
            if (r > 200 && g > 200 && b > 200) return 'White';
            if (r < 50 && g < 50 && b < 50) return 'Black';
            return 'Custom';
        }

        function setPresetColor(r, g, b) {
            currentColor = { r, g, b };
            updateLEDDisplay();
        }

        // Effects management
        function startEffect(effect) {
            stopEffect(effect);
            
            const speedSlider = document.getElementById('speedSlider');
            const speed = speedSlider ? parseInt(speedSlider.value) : 50;
            const interval = Math.max(50, 1100 - (speed * 10));
            
            switch (effect) {
                case 'rainbow':
                    let hue = 0;
                    effectIntervals[effect] = setInterval(() => {
                        const rgb = hslToRgb(hue / 360, 1, 0.5);
                        setEffectColor(rgb.r, rgb.g, rgb.b);
                        hue = (hue + 5) % 360;
                    }, interval);
                    break;
                    
                case 'breathing':
                    let breathingUp = true;
                    let breathingIntensity = 0.3;
                    effectIntervals[effect] = setInterval(() => {
                        if (breathingUp) {
                            breathingIntensity += 0.05;
                            if (breathingIntensity >= 1) breathingUp = false;
                        } else {
                            breathingIntensity -= 0.05;
                            if (breathingIntensity <= 0.3) breathingUp = true;
                        }
                        const rgb = hslToRgb(0, 0.8, breathingIntensity);
                        setEffectColor(rgb.r, rgb.g, rgb.b);
                    }, interval / 2);
                    break;
                    
                case 'strobe':
                    let strobeOn = false;
                    effectIntervals[effect] = setInterval(() => {
                        strobeOn = !strobeOn;
                        if (strobeOn) {
                            setEffectColor(255, 255, 255);
                        } else {
                            setEffectColor(0, 0, 0);
                        }
                    }, interval / 4);
                    break;
                    
                case 'redTherapy':
                    setEffectColor(255, 50, 30);
                    const mainLED = document.getElementById('mainLED');
                    if (mainLED) mainLED.classList.add('pulsing');
                    break;
            }
        }

        function stopEffect(effect) {
            if (effectIntervals[effect]) {
                clearInterval(effectIntervals[effect]);
                delete effectIntervals[effect];
            }
            
            if (effect === 'redTherapy') {
                const mainLED = document.getElementById('mainLED');
                if (mainLED) mainLED.classList.remove('pulsing');
            }
            
            updateLEDDisplay();
        }

        function setEffectColor(r, g, b) {
            const colorString = `rgb(${r}, ${g}, ${b})`;
            const led = document.getElementById('mainLED');
            if (led) {
                const core = led.querySelector('#ledCore');
                const glow = led.querySelector('#ledGlow');
                
                if (core) core.style.background = colorString;
                if (glow) glow.style.background = colorString;
            }
        }

        function updateEffectSpeeds() {
            Object.keys(activeEffects).forEach(effect => {
                if (activeEffects[effect]) {
                    startEffect(effect);
                }
            });
        }

        // Sleep and wellness features
        function startSleepMode() {
            activeEffects.redTherapy = true;
            const toggle = document.getElementById('redTherapyToggle');
            if (toggle) toggle.classList.add('active');
            startEffect('redTherapy');
        }

        function updateStats() {
            const sleepScore = Math.max(60, Math.min(95, 78 + Math.floor(Math.random() * 10) - 5));
            const scoreEl = document.getElementById('sleepScore');
            if (scoreEl) scoreEl.textContent = sleepScore + '%';
        }
        //Breathing exercise functions
        let breathingActive = false;
        let breathingCycleCount = 0;

        function startBreathingExercise() {
            breathingActive = true;
            breathingCycleCount = 0;
            const overlay = document.getElementById('breathingOverlay');
            if (overlay) overlay.classList.add('active');
            runBreathingCycle();
        }

        function runBreathingCycle() {
            if (!breathingActive) return;
            
            const circle = document.getElementById('breathingCircle');
            const instructions = document.getElementById('breathingInstructions');
            
            if (circle) circle.textContent = 'INHALE';
            if (circle) circle.classList.add('inhale');
            if (circle) circle.classList.remove('exhale');
            if (instructions) instructions.textContent = 'Breathe in slowly through your nose...';
            
            setTimeout(() => {
                if (!breathingActive) return;
                if (circle) circle.textContent = 'HOLD';
                if (circle) circle.classList.remove('inhale');
                if (instructions) instructions.textContent = 'Hold your breath gently...';
                
                setTimeout(() => {
                    if (!breathingActive) return;
                    if (circle) circle.textContent = 'EXHALE';
                    if (circle) circle.classList.add('exhale');
                    if (instructions) instructions.textContent = 'Breathe out slowly through your mouth...';
                    
                    setTimeout(() => {
                        if (!breathingActive) return;
                        breathingCycleCount++;
                        const cycleEl = document.getElementById('breathingCycle');
                        if (cycleEl) cycleEl.textContent = breathingCycleCount;
                        
                        if (breathingCycleCount < 5) {
                            runBreathingCycle();
                        } else {
                            stopBreathing();
                        }
                    }, 8000);
                }, 7000);
            }, 4000);
        }

        function stopBreathing() {
            breathingActive = false;
            const overlay = document.getElementById('breathingOverlay');
            if (overlay) overlay.classList.remove('active');
        }

        // Utility functions
        function hslToRgb(h, s, l) {
            let r, g, b;
            
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        // Touch gestures
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Make functions globally available
        window.openEffectsPopup = openEffectsPopup;
        window.closeEffectsPopup = closeEffectsPopup;
        window.toggleEffect = toggleEffect;
    </script>
</body>
</html>